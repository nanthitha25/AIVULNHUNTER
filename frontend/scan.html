<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Scan - AivulnHunter</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

<header>
  <h2>üõ°Ô∏è AivulnHunter</h2>
  <nav>
    <a href="index.html">Home</a>
    <a href="agents.html">Agents</a>
    <a href="scan.html" class="active">Scan</a>
    <a href="rl.html">RL Heatmap</a>
    <a href="admin_login.html">Admin</a>
  </nav>
</header>

<div class="scan-container">
  <h2>üîç Vulnerability Scan</h2>
  <p class="subtitle">Real-time security testing for AI systems</p>
  
  <!-- Scan Type Selector -->
  <div class="form-group">
    <label>Scan Type</label>
    <select id="scanType" onchange="toggleScanInput()">
      <option value="API">üåê API / LLM Endpoint</option>
      <option value="DATASET">üìÅ Dataset Upload</option>
    </select>
  </div>

  <!-- URL Input -->
  <div id="urlInput">
    <div class="form-group">
      <label>Target URL</label>
      <input id="scanTarget" placeholder="http://localhost:9000/chat">
      <span class="hint">Enter LLM or API endpoint URL</span>
    </div>
    <div class="example-urls">
      <span>Examples:</span>
      <code>http://localhost:9000/chat</code>
      <code>https://api.example.com/v1/llm</code>
      <code>https://test-ai-service/run</code>
    </div>
  </div>

  <!-- Dataset Input -->
  <div id="datasetInput" style="display:none">
    <div class="form-group">
      <label>Upload Dataset</label>
      <input type="file" id="datasetFile" accept=".json,.csv">
      <span class="hint">Upload JSON or CSV file with target data</span>
    </div>
  </div>

  <button class="start-btn" onclick="startUnifiedScan()">
    <i class="fa-solid fa-rocket"></i> Start Scan
  </button>

  <button class="download-btn" onclick="downloadPDF()" style="display: none;" id="downloadPdfBtn">
    <i class="fa-solid fa-file-pdf"></i> Download PDF Report
  </button>

  <hr>

  <!-- Agent Timeline -->
  <h3>Agent Execution Timeline</h3>
  <div class="timeline">
    <div class="step" id="agent-profile">
      <span class="step-icon">üïµÔ∏è</span>
      <span class="step-text">Profiling</span>
      <span class="step-status">WAITING</span>
    </div>
    <div class="step" id="agent-strategy">
      <span class="step-icon">‚ôüÔ∏è</span>
      <span class="step-text">Strategy</span>
      <span class="step-status">WAITING</span>
    </div>
    <div class="step" id="agent-execute">
      <span class="step-icon">‚öîÔ∏è</span>
      <span class="step-text">Execution</span>
      <span class="step-status">WAITING</span>
    </div>
    <div class="step" id="agent-observer">
      <span class="step-icon">üëÅ</span>
      <span class="step-text">Observer</span>
      <span class="step-status">WAITING</span>
    </div>
  </div>

  <!-- Progress Bar -->
  <div class="progress-container">
    <progress id="scanProgress" value="0" max="100" style="display: none;"></progress>
    <span id="progressPercent" style="display: none;">0%</span>
    <p id="agentStatus" class="agent-status"></p>
  </div>

  <hr>

  <!-- Results Section -->
  <h3>Scan Results</h3>
  <div id="scanResults">
    <div class="info-box">
      <h3>üìã Getting Started</h3>
      <p>Choose a scan type above and click "Start Scan" to begin vulnerability testing.</p>
      <ul>
        <li><strong>API / LLM Endpoint:</strong> Real-time probing of live URLs</li>
        <li><strong>Dataset Upload:</strong> Scan targets from a JSON or CSV file</li>
      </ul>
      <p class="note"><strong>Note:</strong> Only scan systems you own or have permission to test.</p>
    </div>
  </div>
</div>

<style>
.form-group {
  margin: 15px 0;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: #333;
}

.form-group select,
.form-group input[type="text"],
.form-group input[type="file"] {
  width: 100%;
  max-width: 500px;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
}

.form-group select:focus,
.form-group input:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.hint {
  display: block;
  font-size: 12px;
  color: #666;
  margin-top: 5px;
}

.example-urls {
  margin-top: 10px;
  padding: 10px;
  background: #f5f5f5;
  border-radius: 8px;
  font-size: 13px;
}

.example-urls span {
  color: #666;
  margin-right: 10px;
}

.example-urls code {
  background: #e8e8e8;
  padding: 3px 8px;
  border-radius: 4px;
  margin-right: 10px;
  font-size: 12px;
}

.timeline {
  display: flex;
  gap: 15px;
  margin: 20px 0;
  flex-wrap: wrap;
}

.step {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 15px 20px;
  border-radius: 12px;
  background: #2c2c2c;
  color: #aaa;
  min-width: 100px;
  transition: all 0.3s ease;
}

.step.active {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #fff;
  transform: scale(1.05);
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

.step.done {
  background: linear-gradient(135deg, #43a047 0%, #2e7d32 100%);
  color: white;
  box-shadow: 0 4px 15px rgba(67, 160, 71, 0.4);
}

.step.error {
  background: linear-gradient(135deg, #e53935 0%, #c62828 100%);
  color: white;
}

.step-icon {
  font-size: 24px;
  margin-bottom: 5px;
}

.step-text {
  font-size: 12px;
  font-weight: 600;
}

.step-status {
  font-size: 10px;
  margin-top: 5px;
  padding: 2px 8px;
  background: rgba(0,0,0,0.2);
  border-radius: 10px;
}

.card {
  border: 1px solid #ddd;
  padding: 15px;
  margin: 10px 0;
  border-radius: 8px;
  background: white;
  transition: all 0.3s ease;
}

.card:hover {
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.card.VULNERABLE {
  border-left: 5px solid #e53935;
}

.card.SECURE,
.card.PASSED {
  border-left: 5px solid #43a047;
}

.card.CHECK_MANUAL,
card.WARNING {
  border-left: 5px solid #fb8c00;
}

.card.ERROR {
  border-left: 5px solid #9e9e9e;
}

.card h4 {
  margin: 0 0 10px 0;
  color: #333;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card p {
  margin: 5px 0;
  color: #555;
  font-size: 14px;
}

.card p b {
  color: #333;
}

.note {
  background: #fff3cd;
  padding: 10px;
  border-radius: 5px;
  font-size: 13px;
  margin-top: 15px;
  border-left: 4px solid #ffc107;
}

.subtitle {
  color: #666;
  margin-top: -10px;
  margin-bottom: 20px;
}

.agent-status {
  text-align: center;
  color: #667eea;
  font-weight: 500;
  margin-top: 10px;
}
</style>

<script src="js/config.js"></script>
<script src="js/scan.js"></script>

</body>
</html>

