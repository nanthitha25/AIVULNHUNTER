= AIVULNHUNTER - AI Vulnerability Hunter Documentation
:doctype: book
:toc:
:toc-title: Table of Contents
:icons: font
:source-highlighter: highlight.js
:chapter-label:
:pdf-page-size: A4

[IMPORTANT]
====================================================================
**AIVULNHUNTER** is an AI-powered red team security scanner designed to identify vulnerabilities in AI/ML systems, particularly Large Language Models (LLMs) and their APIs.

This project is for **educational and authorized security testing purposes only**.
====================================================================

== Project Overview

=== What is AIVULNHUNTER?

AIVULNHUNTER is a multi-agent vulnerability assessment framework that combines:

* **Target Profiling Agent** - Identifies target type (LLM, API, Web App) and risk level
* **Attack Strategy Agent** - Builds attack plans based on security rules
* **Attack Execution Agent** - Performs simulated vulnerability checks
* **Observer Agent** - Generates explainable AI analysis of findings

The system supports real-time progress tracking via WebSockets and generates PDF vulnerability reports.

=== Key Features

* Multi-agent vulnerability scanning pipeline
* OWASP LLM Top 10 and API security testing
* Real-time progress updates via WebSocket
* PDF report generation
* Reinforcement learning for rule prioritization
* JWT-based authentication
* Modern web interface

=== Project Structure

----
AivulnHunter/
â”œâ”€â”€ backend/                        # FastAPI backend (Python 3.10+)
â”‚   â”œâ”€â”€ main.py                     # Application entry point & routers
â”‚   â”œâ”€â”€ auth.py                     # JWT authentication
â”‚   â”œâ”€â”€ admin_config.py             # Admin credentials configuration
â”‚   â”œâ”€â”€ requirements.txt            # Python dependencies
â”‚   â”œâ”€â”€ ws_manager.py               # WebSocket connection manager
â”‚   â”œâ”€â”€ report_generator.py         # PDF report generation
â”‚   â”œâ”€â”€ scan_api.py                 # Scan endpoints with WS progress
â”‚   â”œâ”€â”€ rules_api.py                # Rules management API
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ auth.py                 # Authentication routes
â”‚   â”‚   â”œâ”€â”€ rules.py                # Rules CRUD routes
â”‚   â”‚   â”œâ”€â”€ scan.py                 # Scan routes
â”‚   â”‚   â””â”€â”€ scan_ws.py              # WebSocket endpoints
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ target_profiling.py     # Target identification agent
â”‚   â”‚   â”œâ”€â”€ attack_strategy.py      # Attack plan builder
â”‚   â”‚   â”œâ”€â”€ executor.py             # Attack simulation agent
â”‚   â”‚   â””â”€â”€ observer.py             # XAI analysis agent
â”‚   â”œâ”€â”€ rl/
â”‚   â”‚   â”œâ”€â”€ learner.py              # RL-based rule scoring
â”‚   â”‚   â””â”€â”€ rule_scores.json        # Rule priority scores
â”‚   â”œâ”€â”€ rules/
â”‚   â”‚   â””â”€â”€ rules.json              # Security rules database
â”‚   â””â”€â”€ datasets/
â”‚       â””â”€â”€ ai_systems.json         # Sample AI targets
â”‚
â”œâ”€â”€ frontend/                       # Frontend interface
â”‚   â”œâ”€â”€ index.html                  # Main landing page
â”‚   â”œâ”€â”€ admin_login.html            # Admin authentication
â”‚   â”œâ”€â”€ admin.html                  # Rule management UI
â”‚   â”œâ”€â”€ admin_rules.html            # Rules administration
â”‚   â”œâ”€â”€ scan.html                   # Vulnerability scanner UI
â”‚   â”œâ”€â”€ agents.html                 # Agent information page
â”‚   â”œâ”€â”€ rl.html                     # RL statistics UI
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”œâ”€â”€ style.css               # Main stylesheet
â”‚   â”‚   â””â”€â”€ admin.css               # Admin panel styles
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ scan.js                 # Scan logic with WebSocket
â”‚   â”‚   â”œâ”€â”€ auth.js                 # Authentication helpers
â”‚   â”‚   â”œâ”€â”€ api.js                  # API service layer
â”‚   â”‚   â”œâ”€â”€ config.js               # Configuration
â”‚   â”‚   â””â”€â”€ admin.js                # Admin functions
â”‚   â”œâ”€â”€ src/                        # React components (optional)
â”‚   â”‚   â”œâ”€â”€ App.jsx
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Scan.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx
â”‚   â”‚   â”‚   â””â”€â”€ Admin.jsx
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”‚       â”œâ”€â”€ ScanForm.jsx
â”‚   â”‚       â”œâ”€â”€ ResultCard.jsx
â”‚   â”‚       â””â”€â”€ Navbar.jsx
â”‚   â””â”€â”€ package.json                # React dependencies
â”‚
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ project.adoc               # This documentation
â”‚
â”œâ”€â”€ reports/                        # Generated PDF reports
â”œâ”€â”€ ai_redteam_project/             # Legacy implementation
â””â”€â”€ venv/                           # Python virtual environment
----

== Installation & Setup

=== Prerequisites

[cols="2,3"]
|===
| Requirement | Description

| Python | 3.10 or higher
| pip | Python package manager
| Git | Version control
| Web Browser | Modern browser (Chrome, Firefox, Safari)
|===

=== Setup Instructions

[source, bash]
----
# Clone the repository
git clone https://github.com/nanthitha25/AIVULNHUNTER.git
cd AivulnHunter

# Create virtual environment
python3 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install backend dependencies
cd backend
pip install -r requirements.txt

# Verify reportlab installation (for PDF generation)
pip install reportlab

# Return to project root
cd ..

# Start the backend server
cd backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000
----

=== Accessing the Application

Once the server is running:

[cols="2,3"]
|===
| URL | Description

| http://localhost:8000 | API base URL
| http://localhost:8000/docs | Swagger API documentation
| http://localhost:8000/redoc | ReDoc API documentation
| frontend/index.html | Landing page
| frontend/scan.html | Vulnerability scanner
| frontend/admin_login.html | Admin login
|===

== API Reference

=== Authentication

All protected endpoints require JWT authentication via the `Authorization` header:

[source, bash]
----
Authorization: Bearer <your_jwt_token>
----

==== POST /admin/login

Authenticate and receive a JWT token.

**Request:**

[source, json]
----
{
  "username": "admin",
  "password": "admin123"
}
----

**Response:**

[source, json]
----
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
----

==== GET /admin/me

Get current authenticated admin info.

[source, bash]
----
curl -H "Authorization: Bearer <token>" http://localhost:8000/admin/me
----

**Response:**

[source, json]
----
{
  "admin": "admin",
  "message": "You are authenticated as an admin"
}
----

=== Rules Management

==== GET /rules/

Retrieve all security rules.

**Response:**

[source, json]
----
[
  {
    "id": 1,
    "name": "Prompt Injection",
    "owasp": "LLM01",
    "severity": "HIGH",
    "priority": 4,
    "enabled": true
  },
  {
    "id": 2,
    "name": "Insecure Output Handling",
    "owasp": "LLM02",
    "severity": "MEDIUM",
    "priority": 3,
    "enabled": true
  }
]
----

==== POST /rules/

Create a new security rule.

**Request:**

[source, json]
----
{
  "name": "Sensitive Information Disclosure",
  "owasp": "LLM06",
  "severity": "HIGH",
  "priority": 4,
  "enabled": true
}
----

==== PUT /rules/{rule_id}

Update an existing rule.

==== DELETE /rules/{rule_id}

Delete a rule.

=== Vulnerability Scanning

==== POST /scan

Start a vulnerability scan on a target.

**Request:**

[source, bash]
----
curl -X POST \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"target_id": "llm_001", "target_type": "llm"}' \
  http://localhost:8000/scan
----

**Response:**

[source, json]
----
{
  "scan_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "timestamp": "2025-02-01T10:30:00.000Z",
  "target": {
    "id": "llm_001",
    "name": "ChatGPT API",
    "type": "llm"
  },
  "profile": {
    "type": "LLM_API",
    "risk_level": "HIGH"
  },
  "results": [
    {
      "attack": "Prompt Injection Test",
      "severity": "HIGH",
      "confidence": 0.85,
      "why": "LLM accepts and executes instructions from untrusted input...",
      "mitigation": "Implement prompt hardening and input filtering..."
    }
  ],
  "report_url": "/scan/a1b2c3d4-e5f6-7890-abcd-ef1234567890/report"
}
----

==== GET /scan/{scan_id}

Get scan results by ID.

==== GET /scan/{scan_id}/report

Download PDF report for a scan.

**Response:** PDF file download

==== GET /scans

List all scans.

=== WebSocket Progress Updates

==== WebSocket /ws/scan/{scan_id}

Connect to receive real-time progress updates during a scan.

**URL:** `ws://localhost:8000/ws/scan/{scan_id}`

**Message Format:**

[source, json]
----
{
  "agent": "Target Profiling",
  "progress": 25,
  "details": "Analyzing target system..."
}
----

**Progress Stages:**

[cols="1,1,2"]
|===
| Agent | Progress | Description

| Target Profiling | 25% | Identifying target type and risk
| Attack Strategy | 50% | Building attack plan from rules
| Attack Execution | 55-75% | Running security checks
| Analysis & XAI | 90-100% | Generating explainable results
|===

== Security Rules

=== OWASP LLM Top 10

The system includes rules for the following vulnerability categories:

[cols="1,1,3"]
|===
| ID | Name | Description

| LLM01 | Prompt Injection | Malicious instructions manipulate model behavior
| LLM02 | Insecure Output Handling | Model outputs lack proper validation
| LLM03 | Training Data Poisoning | Corrupted training data compromises model
| LLM04 | Model Denial of Service | Resource exhaustion attacks on model
| LLM05 | Supply Chain Vulnerabilities | Compromised dependencies or components
| LLM06 | Sensitive Information Disclosure | Model reveals confidential information
|===

=== Rule Configuration

Rules are stored in `backend/rules/rules.json`:

[source, json]
----
[
  {
    "id": 1,
    "name": "Prompt Injection",
    "owasp": "LLM01",
    "severity": "HIGH",
    "priority": 4,
    "description": "Test for prompt injection vulnerabilities",
    "mitigation": "Implement input validation and prompt isolation"
  }
]
----

== Reinforcement Learning

=== Rule Priority Scoring

The system uses reinforcement learning to dynamically adjust rule priorities based on scan results.

[source, python]
----
# Formula: priority = severity_weight * (1 + failure_rate)

def update_rule_priority(rule_id: str, reward: float) -> float:
    """Update rule priority based on vulnerability findings."""
    # Higher rewards increase priority for frequently failing rules
----

=== Rule Scores Storage

Rule scores are persisted in `backend/rl/rule_scores.json`:

[source, json]
----
{
  "LLM01": 0.85,
  "LLM02": 0.72,
  "LLM06": 0.68
}
----

== PDF Report Generation

The system generates comprehensive PDF reports using the ReportLab library.

=== Report Contents

. Target Overview
. Rules Applied
. Vulnerabilities Found
. Severity & Priority Summary
. Mitigation Steps
. Explainable AI Summary

=== Example Report Structure

----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ›¡ï¸ AI Vulnerability Assessment Report    â”‚
â”‚ Generated: 2025-02-01 10:30:00          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. TARGET OVERVIEW                       â”‚
â”‚    Target: ChatGPT API                   â”‚
â”‚    Type: LLM_API                         â”‚
â”‚    Risk: HIGH                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. RULES APPLIED                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚    â”‚ Rule â”‚ Name        â”‚ OWASP  â”‚       â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚    â”‚ 1    â”‚ Prompt Inj. â”‚ LLM01  â”‚       â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. VULNERABILITIES FOUND                 â”‚
â”‚    ðŸ”´ HIGH: Prompt Injection (85%)       â”‚
â”‚    Mitigation: Implement input validationâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

== Frontend Usage

=== Login Flow

. Open `frontend/admin_login.html`
. Enter credentials (admin / admin123)
. JWT token stored in `localStorage`
. Redirect to admin interface

=== Running a Scan

. Navigate to `frontend/scan.html`
. Enter target ID (e.g., `llm_001`)
. Click "Start Scan"
. Watch real-time progress in the agent timeline
. View vulnerability results
. Click "Download PDF Report" for detailed findings

=== Admin Rule Management

. Navigate to `frontend/admin_rules.html`
. View all security rules
. Add new rules with name, OWASP category, severity
. Enable/disable rules
. Delete obsolete rules

== Architecture

=== Multi-Agent Pipeline

[source]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Target ID  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Profiling  â”‚â”€â”€â”€â”€â–¶â”‚    Attack    â”‚
â”‚    Agent     â”‚     â”‚   Strategy   â”‚
â”‚   (25%)      â”‚     â”‚   Agent      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   (50%)      â”‚
                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚    Attack    â”‚â”€â”€â”€â”€â–¶â”‚   Observer   â”‚
                     â”‚  Execution   â”‚     â”‚    Agent     â”‚
                     â”‚   (75%)      â”‚     â”‚   (100%)     â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                 â”‚
                                                 â–¼
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â”‚ PDF Report   â”‚
                                          â”‚ Generation   â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

=== WebSocket Communication

[source]
----
Frontend                                    Backend
   â”‚                                           â”‚
   â”‚  POST /scan {target_id}                   â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚                                           â”‚â—€â”€â”€â” Generate
   â”‚                                           â”‚   â”‚ scan_id
   â”‚                                           â”‚   â”‚
   â”‚  WS /ws/scan/{scan_id}                    â”‚â—€â”€â”€â”¤
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   â”‚ Send progress
   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚ updates
   â”‚  {"agent": "Target Profiling",            â”‚   â”‚
   â”‚   "progress": 25,                         â”‚   â”‚
   â”‚   "details": "Analyzing..."}              â”‚   â”‚
   â”‚                                           â”‚   â”‚
   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
   â”‚  {"agent": "Attack Strategy",             â”‚   â”‚
   â”‚   "progress": 50,                         â”‚   â”‚
   â”‚   "details": "Building plan..."}          â”‚   â”‚
   â”‚                                           â”‚   â”‚
   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
   â”‚  {"agent": "Analysis & XAI",              â”‚   â”‚
   â”‚   "progress": 100,                        â”‚   â”‚
   â”‚   "details": "Scan complete!"}            â”‚   â”‚
   â”‚                                           â”‚   â”‚
   â”‚  Return scan results                      â”‚   â”‚
   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                                           â”‚
----

== Dependencies

=== Backend Requirements

[source, txt]
----
fastapi>=0.109.0
uvicorn[standard]>=0.27.0
python-jose[cryptography]>=3.3.0
passlib[bcrypt]>=1.7.4
python-multipart>=0.0.6
pydantic>=2.7.0
reportlab>=4.0.0
----

=== Frontend Requirements

[source, json]
----
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "axios": "^1.6.0"
  },
  "devDependencies": {
    "vite": "^5.0.0",
    "@vitejs/plugin-react": "^4.2.0"
  }
}
----

== Configuration

=== Admin Credentials

File: `backend/admin_config.py`

[source, python]
----
ADMIN_USERNAME = "admin"
ADMIN_PASSWORD = "admin123"
SECRET_KEY = "super-secret-key-change-in-production"
ALGORITHM = "HS256"
----

[WARNING]
====
**Security Notice:** Change default credentials before deploying to production!

* Use strong passwords
* Store secrets in environment variables
* Implement rate limiting for authentication
====

=== JWT Configuration

[source, python]
----
# Token expiration
ACCESS_TOKEN_EXPIRE_MINUTES = 30

# JWT claims
CLAIMS = {
    "sub": "username",
    "role": "admin",
    "exp": "timestamp"
}
----

== Testing

=== Backend Tests

[source, bash]
----
# Run backend tests
cd backend
python -m pytest test_agents.py -v
python -m pytest test_pipeline.py -v
----

=== Manual Testing

. Start the backend server
. Open `frontend/admin_login.html`
. Login with admin/admin123
. Navigate to `frontend/scan.html`
. Enter target ID and run scan
. Verify WebSocket progress updates
. Check PDF report generation

== Contributing

. Fork the repository
. Create a feature branch (`git checkout -b feature/new-agent`)
. Make changes following project conventions
. Add tests for new functionality
. Submit pull request

== License

This project is provided for educational and research purposes only.

=== Disclaimer

[IMPORTANT]
====================================================================
**Authorization Required:** This tool should only be used on systems you own or have explicit permission to test.

**No Warranty:** The software is provided "as is" without any warranties.

**Educational Use Only:** Intended for learning about AI/ML security vulnerabilities.
====================================================================

== Author

**Nanthitha Venkatachapathy**

* GitHub: https://github.com/nanthitha25/AIVULNHUNTER

== Changelog

=== Version 1.0.0 (2025-02-01)

* Initial release
* Multi-agent vulnerability scanning
* WebSocket real-time progress updates
* PDF report generation
* RL-based rule prioritization
* JWT authentication
* Web interface for scanning and rule management

== Appendices

=== Appendix A: OWASP LLM Top 10 Reference

[cols="2,3"]
|===
| Category | Reference

| LLM01: Prompt Injection | https://owasp.org/www-project-top-10-for-large-language-model-applications/
| LLM02: Insecure Output Handling | https://cheatsheetseries.owasp.org/cheatsheets/LLM_Security_Cheat_Sheet.html
| LLM03: Training Data Poisoning | https://owasp.org/www-project-top-10-for-large-language-model-applications/
|===

=== Appendix B: API Endpoints Quick Reference

[cols="2,2,1"]
|===
| Method | Endpoint | Description

| POST | /admin/login | Get JWT token
| GET | /admin/me | Current user info
| GET | /rules/ | List all rules
| POST | /rules/ | Create rule
| PUT | /rules/{id} | Update rule
| DELETE | /rules/{id} | Delete rule
| POST | /scan | Start scan
| GET | /scan/{id} | Get scan results
| GET | /scan/{id}/report | Download PDF
| GET | /scans | List all scans
| WS | /ws/scan/{id} | Progress updates
| POST | /report | Generate report
|===

=== Appendix C: Environment Variables

[source, bash]
----
# Optional environment configuration
export AIVULN_ADMIN_USERNAME="admin"
export AIVULN_ADMIN_PASSWORD="secure_password"
export AIVULN_JWT_SECRET="your-super-secret-key"
export AIVULN_DATABASE_PATH="./data/rules.json"
----

